---
deck: "JobAcademy::Uncategorized::3-Algorithm"
tags: [uncategorized, programming, debug]
card_id: "nb-3P-03"
fire_weight: 0.7
notion_last_edited: "2026-02-08T17:05:00.000Z"
concept_node: "NB"
---

# nb-3P-03

START
This code crashes on prediction. Fix it.

python
X_c = X[y == c]
self.vars_[idx] = X_c.var(axis=0)


Error: "RuntimeWarning: divide by zero"
END

START
Bug: Zero variance when a feature is constant.

Fix: Add smoothing
python
X_c = X[y == c]
variance = X_c.var(axis=0)
max_var = np.max(variance)
self.vars_[idx] = variance + 1e-9 * max_var


Why max_var: Scales smoothing relative to data magnitude.

sklearn does: var + var_smoothing * np.max(var) (default var_smoothing=1e-9)
END
