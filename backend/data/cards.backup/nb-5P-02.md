---
deck: "JobAcademy::Uncategorized::5-Evaluation"
tags: [uncategorized, programming, build]
card_id: "nb-5P-02"
fire_weight: 0.8
notion_last_edited: "2026-02-08T17:07:00.000Z"
concept_node: "NB"
---

# nb-5P-02

START
Write code to calibrate a NB model and compare before/after.
END

START
python
from sklearn.calibration import CalibratedClassifierCV
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import log_loss

# Uncalibrated
nb = GaussianNB()
nb.fit(X_train, y_train)
proba_uncal = nb.predict_proba(X_test)[:, 1]

# Calibrated
nb_cal = CalibratedClassifierCV(nb, method='isotonic', cv=5)
nb_cal.fit(X_train, y_train)
proba_cal = nb_cal.predict_proba(X_test)[:, 1]

# Compare
print(f"Uncalibrated Log Loss: {log_loss(y_test, proba_uncal):.3f}")
print(f"Calibrated Log Loss: {log_loss(y_test, proba_cal):.3f}")


method='isotonic': Non-parametric, flexible calibration.
END
