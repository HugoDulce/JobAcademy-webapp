---
deck: "JobAcademy::Uncategorized::5-Evaluation"
tags: [uncategorized, programming, integration]
card_id: "nb-6I-01"
fire_weight: 0.9
notion_last_edited: "2026-02-08T17:07:00.000Z"
concept_node: "NB"
---

# nb-6I-01

START
Build complete NB pipeline: load data, split, scale, train, evaluate, calibrate.
END

START
python
import numpy as np
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.naive_bayes import GaussianNB
from sklearn.calibration import CalibratedClassifierCV
from sklearn.metrics import classification_report, roc_auc_score

# Generate data
X, y = make_classification(n_samples=1000, n_features=20, 
                          n_informative=15, n_classes=2,
                          weights=[0.7, 0.3], random_state=42)

# Split with stratification
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, stratify=y, random_state=42
)

# Scale
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# Train
nb = GaussianNB()
nb.fit(X_train_scaled, y_train)

# Evaluate
y_pred = nb.predict(X_test_scaled)
y_proba = nb.predict_proba(X_test_scaled)[:, 1]
print(classification_report(y_test, y_pred))
print(f"ROC-AUC: {roc_auc_score(y_test, y_proba):.3f}")

# Calibrate
nb_cal = CalibratedClassifierCV(nb, method='isotonic', cv=5)
nb_cal.fit(X_train_scaled, y_train)
y_proba_cal = nb_cal.predict_proba(X_test_scaled)[:, 1]
print(f"Calibrated AUC: {roc_auc_score(y_test, y_proba_cal):.3f}")

END
